<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>生成器 Generator | BlaxBerry</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="Chen's Program Study Note">
    
    <link rel="preload" href="/vuepress-studynotes/assets/css/0.styles.176c083a.css" as="style"><link rel="preload" href="/vuepress-studynotes/assets/js/app.30389d4f.js" as="script"><link rel="preload" href="/vuepress-studynotes/assets/js/2.46821667.js" as="script"><link rel="preload" href="/vuepress-studynotes/assets/js/33.a2149542.js" as="script"><link rel="prefetch" href="/vuepress-studynotes/assets/js/10.e706da25.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/100.ba5d9773.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/101.d9624de2.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/102.25ccfead.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/103.0a05bd2b.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/104.c551cbce.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/105.26d7f004.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/106.dc0a210a.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/107.bfebc658.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/108.a3ba13d2.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/109.e986a42a.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/11.07542766.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/110.9482ca1d.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/111.4e346e7d.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/112.2e64df36.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/113.b1e80553.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/114.4a3f4b68.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/12.5024e7e5.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/13.fc73383b.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/14.4fd797ac.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/15.5cf4a76b.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/16.8383574d.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/17.439bddab.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/18.2a074496.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/19.9a1c1603.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/20.4a9fb451.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/21.cbdab64b.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/22.2003c766.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/23.bf49e2a0.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/24.46bd37b7.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/25.51fca31f.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/26.393f1e53.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/27.3d312874.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/28.a5aecfb2.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/29.45981af1.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/3.69e2f16e.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/30.723e7571.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/31.d812d5a6.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/32.a31e1700.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/34.415ab6ad.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/35.3df59d3f.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/36.0c3ae1d6.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/37.091fc529.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/38.eead2b44.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/39.ec7780dc.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/4.eae2ed54.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/40.22891425.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/41.b44dc0b1.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/42.5f1bfd9a.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/43.36c2df56.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/44.89021fec.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/45.bee55f69.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/46.13f2b4e3.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/47.9da74a8e.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/48.fc794b60.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/49.a7e0f60b.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/5.b9776549.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/50.a2682f6f.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/51.ead64a4a.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/52.46c46ab7.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/53.48523062.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/54.1a15da6f.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/55.ba10d1c3.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/56.cf24b30d.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/57.2b18eedd.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/58.e98d86be.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/59.3bcdbf10.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/6.451c0322.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/60.93c7ed57.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/61.9b70518f.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/62.286bd776.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/63.2c796713.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/64.82c866c1.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/65.5a24b678.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/66.cf495053.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/67.b5160447.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/68.5ba4ddf4.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/69.838030d7.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/7.d00e6429.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/70.6c4cf0bb.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/71.71aa92c6.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/72.ab614f8c.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/73.4bdd10c4.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/74.0767d483.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/75.34f7bbb2.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/76.6f758d88.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/77.102d4e60.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/78.f42269f4.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/79.64d521ae.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/8.51891b2d.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/80.3345fd6e.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/81.ea1dc131.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/82.1836f0b7.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/83.8ecf8e6c.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/84.26017f81.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/85.db637a34.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/86.a4c5a167.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/87.30a2be99.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/88.bfd5c52c.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/89.d88c50c5.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/9.7df40ce7.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/90.d4d4081f.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/91.251cbf9c.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/92.f9ede41f.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/93.6faf780f.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/94.bed941ed.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/95.33151d89.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/96.9ff28f44.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/97.0526fba3.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/98.b8f1e48f.js"><link rel="prefetch" href="/vuepress-studynotes/assets/js/99.f5693aa2.js">
    <link rel="stylesheet" href="/vuepress-studynotes/assets/css/0.styles.176c083a.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress-studynotes/" class="home-link router-link-active"><img src="/vuepress-studynotes/logo.jpg" alt="BlaxBerry" class="logo"> <span class="site-name can-hide">BlaxBerry</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress-studynotes/notes/front/JavaScript/" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/vuepress-studynotes/notes/front/React/" class="nav-link">
  React.js
</a></div><div class="nav-item"><a href="/vuepress-studynotes/notes/front/Vue/" class="nav-link">
  Vue.js
</a></div><div class="nav-item"><a href="/vuepress-studynotes/notes/back/Python/" class="nav-link router-link-active">
  Python
</a></div><div class="nav-item"><a href="/vuepress-studynotes/guide/front/" class="nav-link">
  前端目录
</a></div><div class="nav-item"><a href="/vuepress-studynotes/guide/back/" class="nav-link">
  后端目录
</a></div><div class="nav-item"><a href="/vuepress-studynotes/guide/other/" class="nav-link">
  其他技术
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuepress-studynotes/notes/front/JavaScript/" class="nav-link">
  JavaScript
</a></div><div class="nav-item"><a href="/vuepress-studynotes/notes/front/React/" class="nav-link">
  React.js
</a></div><div class="nav-item"><a href="/vuepress-studynotes/notes/front/Vue/" class="nav-link">
  Vue.js
</a></div><div class="nav-item"><a href="/vuepress-studynotes/notes/back/Python/" class="nav-link router-link-active">
  Python
</a></div><div class="nav-item"><a href="/vuepress-studynotes/guide/front/" class="nav-link">
  前端目录
</a></div><div class="nav-item"><a href="/vuepress-studynotes/guide/back/" class="nav-link">
  后端目录
</a></div><div class="nav-item"><a href="/vuepress-studynotes/guide/other/" class="nav-link">
  其他技术
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>生成器 Generator</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/9.Generator.html#简介" class="sidebar-link">简介</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/9.Generator.html#创建" class="sidebar-link">创建</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/9.Generator.html#列表推导式" class="sidebar-link">列表推导式</a></li><li class="sidebar-sub-header"><a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/9.Generator.html#生成器函数" class="sidebar-link">生成器函数</a></li><li class="sidebar-sub-header"><a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/9.Generator.html#yield" class="sidebar-link">yield</a></li><li class="sidebar-sub-header"><a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/9.Generator.html#return" class="sidebar-link">return</a></li></ul></li><li><a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/9.Generator.html#迭代" class="sidebar-link">迭代</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/9.Generator.html#next" class="sidebar-link">__next__()</a></li><li class="sidebar-sub-header"><a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/9.Generator.html#next-2" class="sidebar-link">next()</a></li><li class="sidebar-sub-header"><a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/9.Generator.html#send" class="sidebar-link">send()</a></li><li class="sidebar-sub-header"><a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/9.Generator.html#for-循环" class="sidebar-link">for 循环</a></li><li class="sidebar-sub-header"><a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/9.Generator.html#错误处理" class="sidebar-link">错误处理</a></li></ul></li><li><a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/9.Generator.html#实例" class="sidebar-link">实例</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/9.Generator.html#打印三角形" class="sidebar-link">打印三角形</a></li><li class="sidebar-sub-header"><a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/9.Generator.html#斐波那契数列" class="sidebar-link">斐波那契数列</a></li><li class="sidebar-sub-header"><a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/9.Generator.html#线程多任务" class="sidebar-link">线程多任务</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="生成器-generator"><a href="#生成器-generator" class="header-anchor">#</a> 生成器 Generator</h1> <p><img src="https://www.python.jp/pages/python_logo2.png" alt=""></p> <p></p><div class="table-of-contents"><ul><li><a href="#简介">简介</a></li><li><a href="#创建">创建</a><ul><li><a href="#列表推导式">列表推导式</a></li><li><a href="#生成器函数">生成器函数</a></li><li><a href="#yield">yield</a></li><li><a href="#return">return</a></li></ul></li><li><a href="#迭代">迭代</a><ul><li><a href="#next">__next__()</a></li><li><a href="#next">next()</a></li><li><a href="#send">send()</a></li><li><a href="#for-循环">for 循环</a></li><li><a href="#错误处理">错误处理</a></li></ul></li><li><a href="#实例">实例</a><ul><li><a href="#打印三角形">打印三角形</a></li><li><a href="#斐波那契数列">斐波那契数列</a></li><li><a href="#线程多任务">线程多任务</a></li></ul></li></ul></div><p></p> <br> <h2 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h2> <p>生成器（Generator）是一个可迭代的对象，</p> <p>可用来生成一组可被迭代的元素的集合</p> <p>生成器创建的集合的元素是按需生成的，比直接全部定义出来节省内存</p> <div class="custom-block tip"><p class="custom-block-title">按需生成元素：</p> <p>假设创建了一个 1000 万个元素的列表，但使用时只需要最开头的几个元素，此时剩余的元素就会白白占了大量内存空间。<br>所以有时创建列表时，<strong>不是一下子生成所有元素</strong>，而是需要用某种算法推算出来，<strong>需要就创建不需要就不创建</strong>，从而节省内存<br>这种算法机制就叫做生成器</p></div> <br> <h2 id="创建"><a href="#创建" class="header-anchor">#</a> 创建</h2> <p>常用下列两种写法创建生成器对象：</p> <ul><li>列表推导式写法（定义简单生成器）</li> <li>生成器函数写法（创建复杂逻辑处理的生成器）</li></ul> <hr> <h3 id="列表推导式"><a href="#列表推导式" class="header-anchor">#</a> 列表推导式</h3> <p>列表推导式写法用于定义简单生成器</p> <p>写法是将列表推导式的 <code>[ ]</code> 改为 <strong><code>( )</code></strong></p> <div class="language-python extra-class"><pre class="language-python"><code>生成器 <span class="token operator">=</span> <span class="token punctuation">(</span> 表达式 <span class="token keyword">for</span> 表达式 <span class="token keyword">in</span> 序列 <span class="token punctuation">)</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">一般列表推导式 与 列表推导式写法的生成器</p> <ul><li>一般列表推导式： <strong><code>[]</code> 定义，返回值为生成的列表</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code>l <span class="token operator">=</span> <span class="token punctuation">[</span>item <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">]</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span> <span class="token comment"># [0, 1, 2]</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>l<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># &lt;class 'list'&gt;</span>
</code></pre></div><ul><li>列表推导式写法的生成器： <strong><code>()</code> 定义，返回值为内存地址</strong></li></ul> <div class="language-python extra-class"><pre class="language-python"><code>g <span class="token operator">=</span> <span class="token punctuation">(</span>item <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span>  <span class="token comment"># &lt;generator object &lt;genexpr&gt; at 0x105093b50&gt;</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># &lt;class 'generator'&gt;</span>
</code></pre></div></div> <hr> <h3 id="生成器函数"><a href="#生成器函数" class="header-anchor">#</a> 生成器函数</h3> <p>普通函数中若有 <code>yield</code> 则函数变为生成器函数</p> <p>可用于定义有复杂逻辑的生成器</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> 生成器函数<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 操作</span>
    <span class="token keyword">yield</span> 数据
    <span class="token comment"># 操作</span>


生成器 <span class="token operator">=</span> 生成器函数<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>生成器函数<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># &lt;generator object gen at 内存地址&gt;</span>
</code></pre></div><p>调用生成器函数后仅创建一个生成器对象，而不执行函数体</p> <p>生成器函数的函数体仅在 <a href="#%E8%BF%AD%E4%BB%A3">迭代生成器</a> 时才会被执行</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    n <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        n <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">yield</span> n


get_gen<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 没有任何反应，只是创建了一个生成器</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>get_gen<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># &lt;generator object get_gen at 0x10d76ef10&gt;</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>get_gen<span class="token punctuation">)</span>  <span class="token comment"># &lt;function get_gen at 0x10d3caa70&gt;</span>
</code></pre></div><p>多次调用生成器函数会创建多个相互独立的生成器</p> <blockquote><p>如下：</p> <p>第一个 while 循环为限循环创建新的生成器，并获取其中第一个元素<br>第二个 while 循环才是循环迭代<strong>同一个生成器对象</strong>，依次按序获取其中的元素</p></blockquote> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> item
		<span class="token keyword">return</span> <span class="token string">&quot;自定义错误信息 啊啊啊啊啊&quot;</span>


<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    gen <span class="token operator">=</span> get_gen<span class="token punctuation">(</span><span class="token punctuation">)</span>
    item <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
<span class="token comment"># 0</span>
<span class="token comment"># 0</span>
<span class="token comment"># 0</span>
<span class="token comment"># ...无序循环</span>


gen <span class="token operator">=</span> get_gen<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    item <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
<span class="token comment"># 0</span>
<span class="token comment"># 1</span>
<span class="token comment"># 2</span>
<span class="token comment"># 报错，StopIteration: 自定义错误信息 啊啊啊啊啊</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">总结</p> <ul><li><p><strong>一般函数：</strong></p> <ul><li>调用后执行函数体，并直接返回结果</li></ul></li> <li><p><strong>生成器函数：</strong></p> <ul><li>调用后不执行函数体，仅创建返回一个生成器对象</li> <li>函数体仅在调用迭代生成器时才会执行，并在 <code>yield</code> 处停止</li> <li>执行生成器函数返回生成器生成列表的元素</li> <li><code>return</code> 返回的是 <code>StopIteration</code> 异常的自定义信息</li></ul></li></ul></div> <hr> <h3 id="yield"><a href="#yield" class="header-anchor">#</a> yield</h3> <p>生成器函数的函数体仅在<a href="#%E8%BF%AD%E4%BB%A3">迭代生成器</a>时才会被执行，</p> <p>执行一次按顺序返回一个元素，返回的是 <code>yield</code> 后的数据</p> <p>在迭代执行生成器对象的过程中 <code>yield</code> 作用相当于 <strong>暂停</strong></p> <blockquote><p>如下：</p> <p>若下例函数是普通函数的话，被调用后会无限循环 <code>+1</code><br>有 <code>yield</code> 的生成器函数被调用后只会创建一个生成器，生成器被 <code>next()</code> 调用后才会执行函数体，但不会无限循环而是在 <code>yield</code> 就暂停了，并且将 <code>+1</code> 后新的的 <code>n</code> 返回。再次调用时从 <code>yield</code> 处开始重复上面操作</p></blockquote> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    n <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
        n <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">yield</span> n


get_gen<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># 没有任何反应，只是创建了一个生成器</span>

gen <span class="token operator">=</span> get_gen<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>gen<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>gen<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 2</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>gen<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 3</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">迭代生成器对象的流程：</p> <ol><li><p>第一次执行时：</p> <p>函数体到在 <code>yield</code> 处停止执行，然后 <strong>return</strong> 返回 <code>yield</code> 后的数据</p></li> <li><p>第二次执行时：</p> <p>函数体从前一次停止的 <code>yield</code> 处开始执行，<br>再次遇到 <code>yield</code> 时停止并返回 <code>yield</code> 后的数据</p></li> <li><p>...</p> <p>再次调用时重复上述操作</p></li></ol></div> <blockquote><p>如下：执行迭代时下一次是从上一次的 <code>yield</code> 处开始的</p></blockquote> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
        <span class="token keyword">yield</span> item
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'xxxxx'</span><span class="token punctuation">)</span>


gen <span class="token operator">=</span> get_gen<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span>
<span class="token comment"># 0</span>
<span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span>
<span class="token comment"># xxxx</span>
<span class="token comment"># 1</span>
<span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span>
<span class="token comment"># xxxx</span>
<span class="token comment"># 2</span>
<span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span>
<span class="token comment"># xxxx</span>
<span class="token comment"># 3</span>
</code></pre></div><div class="custom-block tip"><p class="custom-block-title">yield 表达式的返回值</p> <p><code>yield</code> 表达式可以有返回值<br>但因为上述函数体的执行在遇到 <code>yield</code> 就结束，即 <code>=</code> 右侧 <code>yield</code> 表达式结果并没有赋值给左侧变量，所以在下一次执行生成器对象时表达式结果为<code>None</code> <br>若想给 <code>yield</code> 表达式赋值需通过生成器的 <a href="">send()</a> 方法</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
        res <span class="token operator">=</span> <span class="token keyword">yield</span> item
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>res<span class="token punctuation">}</span></span><span class="token string"> xxxxx'</span></span><span class="token punctuation">)</span>


gen <span class="token operator">=</span> get_gen<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span>
<span class="token comment"># 0</span>
<span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span>
<span class="token comment"># None xxxx</span>
<span class="token comment"># 1</span>
<span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span>
<span class="token comment"># None xxxx</span>
<span class="token comment"># 2</span>
<span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span>
<span class="token comment"># None xxxx</span>
<span class="token comment"># 3</span>
</code></pre></div></div> <hr> <h3 id="return"><a href="#return" class="header-anchor">#</a> return</h3> <p>生成器函数中的 <code>return</code> 用于返回生成器中没有元素时 <code>StopIteration</code> 异常的自定义报错信息</p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> 生成器函数<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># 操作</span>
    <span class="token keyword">yield</span> 数据
    <span class="token comment"># 操作</span>
    <span class="token keyword">return</span> <span class="token string">'StopIteration 时的报错信息'</span>


生成器 <span class="token operator">=</span> 生成器函数<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>如下：将元素到头时的报错信息改为自定义啊啊啊啊</p></blockquote> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> item

    <span class="token keyword">return</span> <span class="token string">'啊啊啊啊'</span>


gen <span class="token operator">=</span> get_gen<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 0</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 2</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 报错，StopIteration: 啊啊啊啊</span>
</code></pre></div><blockquote><p>再如下：放入错误 <code>try...except...</code> 错误处理</p></blockquote> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> item
    <span class="token keyword">return</span> <span class="token string">&quot;啊啊啊&quot;</span>


gen <span class="token operator">=</span> get_gen<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        item <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
    <span class="token keyword">except</span> StopIteration <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'错误信息:'</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
        <span class="token keyword">break</span>

<span class="token comment"># 0</span>
<span class="token comment"># 1</span>
<span class="token comment"># 2</span>
<span class="token comment"># 错误信息: 啊啊啊啊</span>
</code></pre></div><br> <h2 id="迭代"><a href="#迭代" class="header-anchor">#</a> 迭代</h2> <p>通过生成器创建的列表的元素，可通过下列两个方法获取：</p> <ul><li>生成器对象的方法： <strong>生成器.__next__()</strong></li> <li>系统内置迭代 <a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/8.Inerator.html">迭代器</a> 的方法： <strong>next(生成器)</strong></li></ul> <p>每次调用方法生成<strong>下一个元素</strong>，不调用则不生成</p> <p>若生成器中没有元素了，会报错抛出 <strong><a href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">StopIteration 异常</a></strong></p> <hr> <h3 id="next"><a href="#next" class="header-anchor">#</a> __next__()</h3> <p>生成器对象的方法</p> <div class="language-python extra-class"><pre class="language-python"><code>生成器<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>调用一次获取下一个生成的元素，不调用不返回新元素</p> <p>若生成的范围结束无法产生新的元素时，调用会报错抛出 <strong><a href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">StopIteration 异常</a></strong></p> <div class="language-python extra-class"><pre class="language-python"><code>g <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 0</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 2</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># StopIteration</span>
</code></pre></div><hr> <h3 id="next-2"><a href="#next-2" class="header-anchor">#</a> next()</h3> <p>生成器是的 <a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/8.Inerator.html">迭代器</a> 的一种，所以也可使用 <a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/8.Inerator.html">迭代器</a> 的 <code>next()</code> 方法来迭代其中元素</p> <p>等同与 <code>__next__()</code></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token builtin">next</span><span class="token punctuation">(</span>生成器<span class="token punctuation">)</span>
</code></pre></div><p>调用一次获取下一个生成的元素，不调用不返回新元素</p> <p>若生成的范围结束无法产生新的元素时，调用会报错抛出 <strong><a href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">StopIteration 异常</a></strong></p> <div class="language-python extra-class"><pre class="language-python"><code>g <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 0</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 2</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>g<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 报错，StopIteration</span>
</code></pre></div><hr> <h3 id="send"><a href="#send" class="header-anchor">#</a> send()</h3> <p>迭代生成器并传值，<strong>传递的参数被赋值给值为 <code>None</code> 的 <a href="#yield">yield 表达式的结果</a></strong></p> <p><code>send()</code> 方法和 <code>__next__()</code> 相同会返回生成器所产生的下一个值</p> <p>但第一次迭代生成器时只能用正常 <code>__next__()</code> ，第二次往后才能使用 <code>send()</code></p> <div class="language-python extra-class"><pre class="language-python"><code>生成器<span class="token punctuation">.</span>send<span class="token punctuation">(</span>值<span class="token punctuation">)</span>
</code></pre></div><blockquote><p>如下：没通过 <code>send()</code> 传值的 <code>yield</code> 表达式的结果为 <code>None</code></p></blockquote> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
        res <span class="token operator">=</span> <span class="token keyword">yield</span> item
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>res<span class="token punctuation">}</span></span><span class="token string"> xxxxx'</span></span><span class="token punctuation">)</span>


gen <span class="token operator">=</span> get_gen<span class="token punctuation">(</span><span class="token punctuation">)</span>

gen<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 0</span>
gen<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># None xxxx</span>
<span class="token comment"># 1</span>
gen<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># None xxxx</span>
<span class="token comment"># 2</span>
gen<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># None xxxx</span>
<span class="token comment"># 3</span>
</code></pre></div><blockquote><p>如下：通过 <code>send()</code> 传值的 <code>yield</code> 表达式的结果为传递的参数</p></blockquote> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
        res <span class="token operator">=</span> <span class="token keyword">yield</span> item
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'</span><span class="token interpolation"><span class="token punctuation">{</span>res<span class="token punctuation">}</span></span><span class="token string"> xxxxx'</span></span><span class="token punctuation">)</span>


gen <span class="token operator">=</span> get_gen<span class="token punctuation">(</span><span class="token punctuation">)</span>

gen<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment"># 0</span>
gen<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">'aaaa'</span><span class="token punctuation">)</span>
<span class="token comment"># aaaa xxxx</span>
<span class="token comment"># 1</span>
gen<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">'bbbb'</span><span class="token punctuation">)</span>
<span class="token comment"># bbbb xxxx</span>
<span class="token comment"># 2</span>
gen<span class="token punctuation">.</span>send<span class="token punctuation">(</span><span class="token string">'cccc'</span><span class="token punctuation">)</span>
<span class="token comment"># cccc xxxx</span>
<span class="token comment"># 3</span>
</code></pre></div><hr> <h3 id="for-循环"><a href="#for-循环" class="header-anchor">#</a> for 循环</h3> <p>生成器 Generator 是个 <a href="/vuepress-studynotes/notes/back/Python/Basic/Basic/8.Inerator.html">迭代器</a> 是个可迭代的对象</p> <p>所以除了通过上 <code>__next__()</code>、<code>next()</code>、<code>send()</code> 迭代执行生成器对象来获取列表元素外，也可直接 <code>for</code> 循环遍历迭代生成器对象获取列表的元素</p> <blockquote><p>如下：直接利用 <code>for</code> 循环遍历生成器</p></blockquote> <div class="language-python extra-class"><pre class="language-python"><code>gen <span class="token operator">=</span> <span class="token punctuation">(</span>item <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> item <span class="token keyword">in</span> gen<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>

<span class="token comment"># 0</span>
<span class="token comment"># 1</span>
<span class="token comment"># 2</span>
<span class="token comment"># 3</span>
</code></pre></div><div class="custom-block warning"><p class="custom-block-title">WARNING</p> <p>但注意 <code>for</code> 遍历迭代生成器对象时 <code>StopItem</code> 异常不会被捕获<br>若需要捕获异常需要通过 <code>while</code> + <code>try...except...else</code> <a href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86">详见</a></p></div> <hr> <h3 id="错误处理"><a href="#错误处理" class="header-anchor">#</a> 错误处理</h3> <p>在迭代生成器对象时，若生成器中没有元素了，会报错抛出 <code>StopIteration</code> 异常</p> <p>可使用 <code>try...except...else</code> 捕获异常</p> <blockquote><p>如下：列表推导式的简单生成器</p></blockquote> <div class="language-python extra-class"><pre class="language-python"><code>gen <span class="token operator">=</span> <span class="token punctuation">(</span>x <span class="token keyword">for</span> x <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        item <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'没有更多元素了'</span><span class="token punctuation">)</span>
        <span class="token keyword">break</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>

<span class="token comment"># 0</span>
<span class="token comment"># 1</span>
<span class="token comment"># 2</span>
<span class="token comment"># 没有更多元素了</span>
</code></pre></div><div class="language-python extra-class"><pre class="language-python"><code>gen <span class="token operator">=</span> <span class="token punctuation">(</span>item <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>gen<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> error<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'错误信息'</span><span class="token punctuation">,</span> error<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
        <span class="token keyword">break</span>

<span class="token comment"># 0</span>
<span class="token comment"># 1</span>
<span class="token comment"># 2</span>
<span class="token comment"># 错误信息 None</span>
</code></pre></div><blockquote><p>如下：生成器函数定义的生成器</p></blockquote> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_gen</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> item
    <span class="token keyword">return</span> <span class="token string">&quot;自定义错误信息 啊啊啊啊啊&quot;</span>


gen <span class="token operator">=</span> get_gen<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        item <span class="token operator">=</span> <span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span>
    <span class="token keyword">except</span> StopIteration <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'错误信息：'</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>value<span class="token punctuation">)</span>
        <span class="token keyword">break</span>
<span class="token comment"># 0</span>
<span class="token comment"># 1</span>
<span class="token comment"># 2</span>
<span class="token comment"># 3</span>
<span class="token comment"># 错误信息： 自定义错误信息 啊啊啊啊啊</span>
</code></pre></div><br> <h2 id="实例"><a href="#实例" class="header-anchor">#</a> 实例</h2> <h3 id="打印三角形"><a href="#打印三角形" class="header-anchor">#</a> 打印三角形</h3> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_gen</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> item <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>count<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">yield</span> item <span class="token operator">*</span> <span class="token string">'*'</span>


gen <span class="token operator">=</span> get_gen<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>

n <span class="token operator">=</span> <span class="token number">1</span>
<span class="token keyword">while</span> n <span class="token operator">&lt;=</span> <span class="token number">5</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>gen<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>
        <span class="token keyword">break</span>


<span class="token comment"># *</span>
<span class="token comment"># **</span>
<span class="token comment"># ***</span>
<span class="token comment"># ****</span>
</code></pre></div><hr> <h3 id="斐波那契数列"><a href="#斐波那契数列" class="header-anchor">#</a> 斐波那契数列</h3> <p><code>0, 1, 1, 2, 3, 5, 8, 13, 21....</code></p> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">get_fibo</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">:</span>
    a<span class="token punctuation">,</span> b <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span>
    n <span class="token operator">=</span> <span class="token number">0</span>

    <span class="token keyword">while</span> n <span class="token operator">&lt;</span> length<span class="token punctuation">:</span>
        <span class="token keyword">yield</span> a
        a<span class="token punctuation">,</span> b <span class="token operator">=</span> b<span class="token punctuation">,</span> a <span class="token operator">+</span> b
        n <span class="token operator">+=</span> <span class="token number">1</span>

    <span class="token keyword">return</span> <span class="token string">'到头了'</span>


gen <span class="token operator">=</span> get_fibo<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 0</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 1</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 2</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 3</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 报错，StopIteration</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">next</span><span class="token punctuation">(</span>gen<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># 报错，StopIteration</span>
</code></pre></div><hr> <h3 id="线程多任务"><a href="#线程多任务" class="header-anchor">#</a> 线程多任务</h3> <div class="custom-block tip"><p class="custom-block-title">进程 》线程 》携程</p> <p>进程：文件下载时整体下载<br>
线程：文件下载时将文件分割为多个小文件同时下载<br>
携程：将线程进一步分割</p></div> <blockquote><p>如下：<strong>进程</strong>（ 按<strong>前后顺序</strong>执行任务 ）</p></blockquote> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">task_1</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'task A </span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">task_2</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'task B </span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>


task_1<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
task_2<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment"># task A 0</span>
<span class="token comment"># task A 1</span>
<span class="token comment"># task B 0</span>
<span class="token comment"># task B 1</span>
</code></pre></div><blockquote><p>如下：<strong>线程</strong>（ <strong>交替</strong>执行任务 ）</p></blockquote> <div class="language-python extra-class"><pre class="language-python"><code><span class="token keyword">def</span> <span class="token function">task_1</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'task A </span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
        <span class="token keyword">yield</span> <span class="token boolean">None</span>


<span class="token keyword">def</span> <span class="token function">task_2</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'task B </span><span class="token interpolation"><span class="token punctuation">{</span>i<span class="token punctuation">}</span></span><span class="token string">'</span></span><span class="token punctuation">)</span>
        <span class="token keyword">yield</span> <span class="token boolean">None</span>


gen_1 <span class="token operator">=</span> task_1<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
gen_2 <span class="token operator">=</span> task_2<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        gen_1<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span>
        gen_2<span class="token punctuation">.</span>__next__<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">pass</span>

<span class="token comment"># task A 0</span>
<span class="token comment"># task B 0</span>
<span class="token comment"># task A 1</span>
<span class="token comment"># task B 1</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">7/18/2022, 5:07:09 PM</span></div></footer> <!----> </main></div><div class="global-ui"><!----></div></div>
    <script src="/vuepress-studynotes/assets/js/app.30389d4f.js" defer></script><script src="/vuepress-studynotes/assets/js/2.46821667.js" defer></script><script src="/vuepress-studynotes/assets/js/33.a2149542.js" defer></script>
  </body>
</html>
