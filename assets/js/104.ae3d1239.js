(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{484:function(_,v,e){"use strict";e.r(v);var t=e(28),a=Object(t.a)({},(function(){var _=this,v=_.$createElement,e=_._self._c||v;return e("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[e("h1",{attrs:{id:"jwt-json-web-token"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#jwt-json-web-token"}},[_._v("#")]),_._v(" JWT ( JSON Web Token)")]),_._v(" "),e("p",[e("img",{attrs:{src:"https://www.freecodecamp.org/news/content/images/size/w2000/2019/11/jwt.png",alt:""}})]),_._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#简介"}},[_._v("简介")])]),e("li",[e("a",{attrs:{href:"#原理"}},[_._v("原理")])]),e("li",[e("a",{attrs:{href:"#组成"}},[_._v("组成")]),e("ul",[e("li",[e("a",{attrs:{href:"#头部-header"}},[_._v("头部（Header）")])]),e("li",[e("a",{attrs:{href:"#负载-playload"}},[_._v("负载（Playload）")])]),e("li",[e("a",{attrs:{href:"#签名-signature"}},[_._v("签名（Signature）")])])])]),e("li",[e("a",{attrs:{href:"#使用"}},[_._v("使用")])]),e("li",[e("a",{attrs:{href:"#缺点"}},[_._v("缺点")])])])]),e("p"),_._v(" "),e("h2",{attrs:{id:"简介"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[_._v("#")]),_._v(" 简介")]),_._v(" "),e("p",[e("strong",[_._v("JWT（JSON Web Token）"),e("strong",[_._v("是主流的")]),_._v("跨域认证解决方案")])]),_._v(" "),e("p",[e("code",[_._v("JWT")]),_._v("的验证方式扩展性好，可支持跨域。")]),_._v(" "),e("p",[_._v("有效使用"),e("code",[_._v("JWT")]),_._v("可减少服务器查询数据库的次数")]),_._v(" "),e("blockquote",[e("ul",[e("li",[e("p",[e("code",[_._v("Session")]),_._v("身份认证机制:"),e("br"),_._v("\n将用户信息数据保存在服务器"),e("br"),_._v("\n适用于客户端网络请求非跨域，比如"),e("strong",[_._v("服务器端渲染")]),_._v("的开发模式")])]),_._v(" "),e("li",[e("p",[e("code",[_._v("JWT")]),_._v("身份认认证机制："),e("br"),_._v("\n将信息数据保存在客户端"),e("br"),_._v("\n适用于客户端网络请求涉及跨域，比如"),e("strong",[_._v("前后端分离")]),_._v("的开发模式")])])])]),_._v(" "),e("h2",{attrs:{id:"原理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#原理"}},[_._v("#")]),_._v(" 原理")]),_._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[_._v("JWT 验证步骤：")]),_._v(" "),e("ol",[e("li",[_._v("客户端登陆请求，发送账号+密码")]),_._v(" "),e("li",[_._v("服务器验证后用户信息数据")]),_._v(" "),e("li",[_._v("服务器给用户信息数据"),e("code",[_._v("JSON")]),_._v("对象加上签名转为"),e("code",[_._v("token")]),_._v("字符串")]),_._v(" "),e("li",[_._v("服务端将生成的"),e("code",[_._v("token")]),_._v("响应回客户端")]),_._v(" "),e("li",[_._v("客户端将"),e("code",[_._v("token")]),_._v("保存到"),e("code",[_._v("localStorage")])]),_._v(" "),e("li",[_._v("此后客户端每次向服务器发送请求时，都在请求头的"),e("code",[_._v("Authorization")]),_._v("字段携带"),e("code",[_._v("token")])]),_._v(" "),e("li",[_._v("服务端将"),e("code",[_._v("token")]),_._v("字符串还原为用户信息数据"),e("code",[_._v("JSON")]),_._v("对象，进行验证，成功后返回响应数据")])])]),_._v(" "),e("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://pbs.twimg.com/media/E3w6jKuVUAki6Id?format=jpg&name=medium"}}),_._v(" "),e("h2",{attrs:{id:"组成"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#组成"}},[_._v("#")]),_._v(" 组成")]),_._v(" "),e("p",[e("code",[_._v("JWT")]),_._v("是个字符串，用点号"),e("code",[_._v(".")]),_._v("隔开分为三部分："),e("code",[_._v("Header.Payload.Signature")])]),_._v(" "),e("p",[_._v("其中"),e("code",[_._v("Payload")]),_._v("部分是用户信息加密后形成的字符串")]),_._v(" "),e("p",[e("code",[_._v("Header")]),_._v("和"),e("code",[_._v("Signature")]),_._v("部分是安全性相关内容，防止"),e("code",[_._v("Payload")]),_._v("被破解")]),_._v(" "),e("img",{staticStyle:{zoom:"25%"},attrs:{src:"https://research.securitum.com/wp-content/uploads/sites/2/2019/10/jwt_ng1_en.png"}}),_._v(" "),e("hr"),_._v(" "),e("h3",{attrs:{id:"头部-header"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#头部-header"}},[_._v("#")]),_._v(" 头部（Header）")]),_._v(" "),e("p",[e("code",[_._v("Header")]),_._v("是描述"),e("code",[_._v("JWT")]),_._v("的元数据")]),_._v(" "),e("p",[_._v("最后通过"),e("code",[_._v("Base64URL")]),_._v("算法转字符串")]),_._v(" "),e("ul",[e("li",[_._v("alg：签名的算法，默认 HS256")]),_._v(" "),e("li",[_._v("typ：该 token 的类型，JWT 的 token 统一为 JWT")])]),_._v(" "),e("hr"),_._v(" "),e("h3",{attrs:{id:"负载-playload"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#负载-playload"}},[_._v("#")]),_._v(" 负载（Playload）")]),_._v(" "),e("p",[e("code",[_._v("Playload")]),_._v("存放实际要传递的数据")]),_._v(" "),e("p",[_._v("最后通过"),e("code",[_._v("Base64URL")]),_._v("算法转字符串")]),_._v(" "),e("ul",[e("li",[_._v("iss：签发人")]),_._v(" "),e("li",[_._v("exp：过期时间")]),_._v(" "),e("li",[_._v("sub：主题")]),_._v(" "),e("li",[_._v("aud：受众")]),_._v(" "),e("li",[_._v("nbf：生效时间")]),_._v(" "),e("li",[_._v("iat：签发时间")]),_._v(" "),e("li",[_._v("jti：编号")])]),_._v(" "),e("p",[_._v("除了上面 6 个官方字段，还可以自定义私有字段")]),_._v(" "),e("p",[e("code",[_._v("JWT")]),_._v("默认不加密，不建议在此存放私密信息，一般仅存放用户名、用户 ID、邮箱")]),_._v(" "),e("hr"),_._v(" "),e("h3",{attrs:{id:"签名-signature"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#签名-signature"}},[_._v("#")]),_._v(" 签名（Signature）")]),_._v(" "),e("p",[e("code",[_._v("Signature")]),_._v("是对头部和负载部分的签名，防止数据被篡改。")]),_._v(" "),e("p",[_._v("签名不能实现数据加密，因为"),e("code",[_._v("JWT")]),_._v("默认信息透明不保密，需要指定一个秘钥（secret），仅服务器知道不告诉客户端。然后通过"),e("code",[_._v("JWT")]),_._v("头部"),e("code",[_._v("Header")]),_._v("中的签名算法生成签名，最后将"),e("code",[_._v("Header")]),_._v("、"),e("code",[_._v("Playload")]),_._v("、"),e("code",[_._v("Signature")]),_._v("三部分合成一个点号"),e("code",[_._v(".")]),_._v("隔开的"),e("code",[_._v("token")]),_._v("字符串")]),_._v(" "),e("h2",{attrs:{id:"使用"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[_._v("#")]),_._v(" 使用")]),_._v(" "),e("p",[e("code",[_._v("JWT")]),_._v("官方推荐了对应各个环境的"),e("code",[_._v("JWT")]),_._v("库：")]),_._v(" "),e("p",[e("a",{attrs:{href:"https://jwt.io/libraries",target:"_blank",rel:"noopener noreferrer"}},[_._v("suggested JWT libraries"),e("OutboundLink")],1),_._v("：")]),_._v(" "),e("blockquote",[e("p",[_._v("比如：Node.js 下使用的 "),e("strong",[_._v("jsonwebtoken")])]),_._v(" "),e("p",[_._v("详见 "),e("a",{attrs:{href:""}},[_._v("Express.js + JWT 身份验证")])])]),_._v(" "),e("h2",{attrs:{id:"缺点"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#缺点"}},[_._v("#")]),_._v(" 缺点")]),_._v(" "),e("p",[e("code",[_._v("JWT")]),_._v("一旦签发除"),e("code",[_._v("token")]),_._v("无法废，数据被保存在客户端而不是在服务器。")]),_._v(" "),e("p",[_._v("为了防止泄露盗用，需要在生成"),e("code",[_._v("token")]),_._v("时设置较短的有效期")]),_._v(" "),e("p",[e("code",[_._v("JWT")]),_._v("信息透明，默认不加密，不能将私密信息写入"),e("code",[_._v("token")])]),_._v(" "),e("p",[_._v("为了减少盗用，不建议使用"),e("code",[_._v("HTTP")]),_._v("明码传输，应该用"),e("code",[_._v("HTTPS")]),_._v("协议传输")])])}),[],!1,null,null,null);v.default=a.exports}}]);