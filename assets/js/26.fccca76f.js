(window.webpackJsonp=window.webpackJsonp||[]).push([[26],{407:function(v,_,t){"use strict";t.r(_);var e=t(28),a=Object(e.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("h1",{attrs:{id:"jwt-身份验证"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jwt-身份验证"}},[v._v("#")]),v._v(" JWT 身份验证")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://traveler0401.com/wp-content/uploads/2018/12/JWT%E3%81%A3%E3%81%A6%E4%BD%95%EF%BC%9F%E4%BB%95%E6%A7%98%E3%82%84%E7%89%B9%E5%BE%B4%E3%83%BB%E6%A7%8B%E6%88%90%E3%82%92%E8%B6%85%E7%B0%A1%E5%8D%98%E3%81%AB%E8%A7%A3%E8%AA%AC%EF%BC%81.jpg",alt:""}})]),v._v(" "),t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#简介"}},[v._v("简介")])]),t("li",[t("a",{attrs:{href:"#原理"}},[v._v("原理")])]),t("li",[t("a",{attrs:{href:"#组成"}},[v._v("组成")]),t("ul",[t("li",[t("a",{attrs:{href:"#头部-header"}},[v._v("头部（Header）")])]),t("li",[t("a",{attrs:{href:"#负载-playload"}},[v._v("负载（Playload）")])]),t("li",[t("a",{attrs:{href:"#签名-signature"}},[v._v("签名（Signature）")])])])]),t("li",[t("a",{attrs:{href:"#使用"}},[v._v("使用")])]),t("li",[t("a",{attrs:{href:"#缺点"}},[v._v("缺点")])])])]),t("p"),v._v(" "),t("h2",{attrs:{id:"简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[v._v("#")]),v._v(" 简介")]),v._v(" "),t("p",[t("strong",[v._v("JWT（JSON Web Token）"),t("strong",[v._v("是主流的")]),v._v("跨域认证解决方案")])]),v._v(" "),t("p",[t("code",[v._v("JWT")]),v._v("的验证方式扩展性好，可支持跨域。")]),v._v(" "),t("p",[v._v("有效使用"),t("code",[v._v("JWT")]),v._v("可减少服务器查询数据库的次数")]),v._v(" "),t("blockquote",[t("ul",[t("li",[t("p",[t("code",[v._v("Session")]),v._v("身份认证机制:"),t("br"),v._v("\n将用户信息数据保存在服务器"),t("br"),v._v("\n适用于客户端网络请求非跨域，比如"),t("strong",[v._v("服务器端渲染")]),v._v("的开发模式")])]),v._v(" "),t("li",[t("p",[t("code",[v._v("JWT")]),v._v("身份认认证机制："),t("br"),v._v("\n将信息数据保存在客户端"),t("br"),v._v("\n适用于客户端网络请求涉及跨域，比如"),t("strong",[v._v("前后端分离")]),v._v("的开发模式")])])])]),v._v(" "),t("h2",{attrs:{id:"原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#原理"}},[v._v("#")]),v._v(" 原理")]),v._v(" "),t("div",{staticClass:"custom-block tip"},[t("p",{staticClass:"custom-block-title"},[v._v("JWT 验证步骤：")]),v._v(" "),t("ol",[t("li",[v._v("客户端登陆请求，发送账号+密码")]),v._v(" "),t("li",[v._v("服务器验证后用户信息数据")]),v._v(" "),t("li",[v._v("服务器给用户信息数据"),t("code",[v._v("JSON")]),v._v("对象加上签名转为"),t("code",[v._v("token")]),v._v("字符串")]),v._v(" "),t("li",[v._v("服务端将生成的"),t("code",[v._v("token")]),v._v("响应回客户端")]),v._v(" "),t("li",[v._v("客户端将"),t("code",[v._v("token")]),v._v("保存到"),t("code",[v._v("localStorage")])]),v._v(" "),t("li",[v._v("此后客户端每次向服务器发送请求时，都在请求头的"),t("code",[v._v("Authorization")]),v._v("字段携带"),t("code",[v._v("token")])]),v._v(" "),t("li",[v._v("服务端将"),t("code",[v._v("token")]),v._v("字符串还原为用户信息数据"),t("code",[v._v("JSON")]),v._v("对象，进行验证，成功后返回响应数据")])])]),v._v(" "),t("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://pbs.twimg.com/media/E3w6jKuVUAki6Id?format=jpg&name=medium"}}),v._v(" "),t("h2",{attrs:{id:"组成"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#组成"}},[v._v("#")]),v._v(" 组成")]),v._v(" "),t("p",[t("code",[v._v("JWT")]),v._v("是个字符串，用点号"),t("code",[v._v(".")]),v._v("隔开分为三部分："),t("code",[v._v("Header.Payload.Signature")])]),v._v(" "),t("p",[v._v("其中"),t("code",[v._v("Payload")]),v._v("部分是用户信息加密后形成的字符串")]),v._v(" "),t("p",[t("code",[v._v("Header")]),v._v("和"),t("code",[v._v("Signature")]),v._v("部分是安全性相关内容，防止"),t("code",[v._v("Payload")]),v._v("被破解")]),v._v(" "),t("img",{staticStyle:{zoom:"25%"},attrs:{src:"https://research.securitum.com/wp-content/uploads/sites/2/2019/10/jwt_ng1_en.png"}}),v._v(" "),t("hr"),v._v(" "),t("h3",{attrs:{id:"头部-header"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#头部-header"}},[v._v("#")]),v._v(" 头部（Header）")]),v._v(" "),t("p",[t("code",[v._v("Header")]),v._v("是描述"),t("code",[v._v("JWT")]),v._v("的元数据")]),v._v(" "),t("p",[v._v("最后通过"),t("code",[v._v("Base64URL")]),v._v("算法转字符串")]),v._v(" "),t("ul",[t("li",[v._v("alg：签名的算法，默认 HS256")]),v._v(" "),t("li",[v._v("typ：该 token 的类型，JWT 的 token 统一为 JWT")])]),v._v(" "),t("hr"),v._v(" "),t("h3",{attrs:{id:"负载-playload"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#负载-playload"}},[v._v("#")]),v._v(" 负载（Playload）")]),v._v(" "),t("p",[t("code",[v._v("Playload")]),v._v("存放实际要传递的数据")]),v._v(" "),t("p",[v._v("最后通过"),t("code",[v._v("Base64URL")]),v._v("算法转字符串")]),v._v(" "),t("ul",[t("li",[v._v("iss：签发人")]),v._v(" "),t("li",[v._v("exp：过期时间")]),v._v(" "),t("li",[v._v("sub：主题")]),v._v(" "),t("li",[v._v("aud：受众")]),v._v(" "),t("li",[v._v("nbf：生效时间")]),v._v(" "),t("li",[v._v("iat：签发时间")]),v._v(" "),t("li",[v._v("jti：编号")])]),v._v(" "),t("p",[v._v("除了上面 6 个官方字段，还可以自定义私有字段")]),v._v(" "),t("p",[t("code",[v._v("JWT")]),v._v("默认不加密，不建议在此存放私密信息，一般仅存放用户名、用户 ID、邮箱")]),v._v(" "),t("hr"),v._v(" "),t("h3",{attrs:{id:"签名-signature"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#签名-signature"}},[v._v("#")]),v._v(" 签名（Signature）")]),v._v(" "),t("p",[t("code",[v._v("Signature")]),v._v("是对头部和负载部分的签名，防止数据被篡改。")]),v._v(" "),t("p",[v._v("签名不能实现数据加密，因为"),t("code",[v._v("JWT")]),v._v("默认信息透明不保密，需要指定一个秘钥（secret），仅服务器知道不告诉客户端。然后通过"),t("code",[v._v("JWT")]),v._v("头部"),t("code",[v._v("Header")]),v._v("中的签名算法生成签名，最后将"),t("code",[v._v("Header")]),v._v("、"),t("code",[v._v("Playload")]),v._v("、"),t("code",[v._v("Signature")]),v._v("三部分合成一个点号"),t("code",[v._v(".")]),v._v("隔开的"),t("code",[v._v("token")]),v._v("字符串")]),v._v(" "),t("h2",{attrs:{id:"使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用"}},[v._v("#")]),v._v(" 使用")]),v._v(" "),t("p",[t("code",[v._v("JWT")]),v._v("官方推荐了对应各个环境的"),t("code",[v._v("JWT")]),v._v("库：")]),v._v(" "),t("p",[t("a",{attrs:{href:"https://jwt.io/libraries",target:"_blank",rel:"noopener noreferrer"}},[v._v("suggested JWT libraries"),t("OutboundLink")],1),v._v("：")]),v._v(" "),t("blockquote",[t("p",[v._v("比如：Node.js 下使用的 "),t("strong",[v._v("jsonwebtoken")])]),v._v(" "),t("p",[v._v("详见 "),t("a",{attrs:{href:""}},[v._v("Express.js + JWT 身份验证")])])]),v._v(" "),t("h2",{attrs:{id:"缺点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#缺点"}},[v._v("#")]),v._v(" 缺点")]),v._v(" "),t("p",[t("code",[v._v("JWT")]),v._v("一旦签发除"),t("code",[v._v("token")]),v._v("无法废，数据被保存在客户端而不是在服务器。")]),v._v(" "),t("p",[v._v("为了防止泄露盗用，需要在生成"),t("code",[v._v("token")]),v._v("时设置较短的有效期")]),v._v(" "),t("p",[t("code",[v._v("JWT")]),v._v("信息透明，默认不加密，不能将私密信息写入"),t("code",[v._v("token")])]),v._v(" "),t("p",[v._v("为了减少盗用，不建议使用"),t("code",[v._v("HTTP")]),v._v("明码传输，应该用"),t("code",[v._v("HTTPS")]),v._v("协议传输")])])}),[],!1,null,null,null);_.default=a.exports}}]);